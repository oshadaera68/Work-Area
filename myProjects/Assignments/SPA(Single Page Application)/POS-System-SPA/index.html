<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <meta content="width= deviwidth=device-width, initial-scale=1" name="viewport">
    <link href="assets/Bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <title>MA POS System</title>
    <style>
        .table-hover {
            position: relative;
            left: -288px;
        }

        #searchCus {
            position: absolute;
            left: 132vh;
        }

        #clear {
            position: absolute;
            left: 153vh;
            top: 461px;
        }


    </style>
</head>
<body>
<main>

    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">MA POS System</a>
            <button aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation"
                    class="navbar-toggler"
                    data-bs-target="#navbarNavDropdown" data-bs-toggle="collapse" type="button">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-end" id="navbarNavDropdownhome">
                <ul class="nav justify-content-center">
                    <li class="nav-item">
                        <a aria-current="page" class="nav-link active" href="#" id="homeBtn">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" id="customerBtn">Customer</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" id="itemBtn">Item</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <section id="homepage">
        <div class="page" id="home">
            <div class="row">
                <div class="col">
                </div>
                <div class="col">
                    <div class="row mb-3">
                        <label class="col-sm-3 col-form-label" for="inputEmail3">Oreder Id</label>
                        <div class="col-sm-6">
                            <input class="form-control" id="inputEmail3" type="text">
                        </div>
                    </div>
                </div>
                <div class="col">
                </div>
            </div>
            <div class="row">

                <div class="col ">
                    <h4 align="center" class="align-content-center" text>Customer</h4>
                    <form class="form-floating">
                        <input class="form-control" id="customerID" placeholder="" type="text" value="">
                        <label for="customerID">Input Customer ID</label>
                    </form>
                    <br>
                    <form class="form-floating">
                        <input class="form-control" id="customerName" placeholder="" type="text" value="">
                        <label for="customerName">Input Name</label>
                    </form>
                    <br>
                    <form class="form-floating">
                        <input class="form-control" id="customerAddress" placeholder="" type="text" value="">
                        <label for="customerAddress">Input Address</label>
                    </form>
                    <br>
                    <form class="form-floating">
                        <input class="form-control" id="customertpnumber" placeholder="" type="text" value="">
                        <label for="customertpnumber">Input with Tp Number</label>
                    </form>
                    <br>
                    <form class="form-floating">
                        <input class="form-control" id="customerpoints" placeholder="" type="text" value="">
                        <label for="customerpoints">Input pointse</label>
                    </form>
                    <br>
                    <button class="btn btn-success justify-content-center" type="button">Add to cart</button>

                </div>

                <div class="col">

                    <h4 align="center" class="justify-content-center" text>Item</h4>
                    <form class="form-floating">
                        <input class="form-control" id="iId" placeholder="" type="text" value="">
                        <label for="iId">Input Customer ID</label>
                    </form>
                    <br>
                    <form class="form-floating">
                        <input class="form-control" id="iName" placeholder="" type="text" value="">
                        <label for="iName">Input Brand</label>
                    </form>
                    <br>
                    <form class="form-floating">
                        <input class="form-control" id="itemQty" placeholder="" type="text" value="">
                        <label for="itemQty">Input Qty</label>
                    </form>
                    <br>
                    <form class="form-floating">
                        <input class="form-control" id="unitPrice" placeholder="" type="text" value="">
                        <label for="unitPrice">Input UnitPrice</label>
                    </form>
                    <br>

                    <br>
                    <button class="btn btn-warning justify-content-center" type="button">Remove from the cart</button>
                </div>
                <div class="col-6">
                    <div class="row g-3">
                        <h4 align="center" class="justify-content-center">Order detail</h4>
                        <div class="col">
                            <input aria-label="Total" class="form-control" placeholder="Total" type="text">
                        </div>

                        <div class="col">
                            <input aria-label="Paying Amount" class="form-control" placeholder="Paying Amount"
                                   type="text">
                        </div>
                        <br><br>
                        <div class="row g-3">
                            <div class="col">
                                <input aria-label="Discounts" class="form-control" placeholder="Discounts" type="text">
                            </div>

                            <div class="col">
                                <input aria-label="Balance" class="form-control" placeholder="Balance " type="text">
                            </div>
                        </div>
                        <br>
                        <table class="table bg-danger text-white">
                            <thead>
                            <tr>
                                <th scope="col">ItemId</th>
                                <th scope="col">Brand</th>
                                <th scope="col">Qty</th>
                                <th scope="col">Price</th>
                            </tr>
                            </thead>
                            <tbody>

                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="customerpage">
        <div class="page" id="customer">
            <br>
            <div class="row">
                <div class="col">
                </div>

                <div class="col ">
                    <h4 class="align-content-center" text>Customer</h4>
                    <br>
                    <form class="form-floating">
                        <input class="form-control" id="id" placeholder="" type="text" value="">
                        <label for="id">Input Customer ID</label>
                        <p><small id="cusId" class="text-danger pl-1"></small></p>
                    </form>
                    <form class="form-floating">
                        <input class="form-control" id="name" placeholder="" type="text" value="">
                        <label for="name">Input Name</label>
                        <p><small id="cusName" class="text-danger pl-1"></small></p>
                    </form>
                    <form class="form-floating">
                        <input class="form-control" id="address" placeholder="" type="text" value="">
                        <label for="address">Input Address</label>
                        <p><small id="cusAddress" class="text-danger pl-1"></small></p>
                    </form>
                    <form class="form-floating">
                        <input class="form-control" id="tpNum" placeholder="" type="text" value="">
                        <label for="tpNum">Input with Tp Number</label>
                        <p><small id="cusTpNum" class="text-danger pl-1"></small></p>
                    </form>
                    <br>
                    <button class="btn btn-success" id="addCustomer" type="button">Add Customer</button>
                    <button class="btn btn-info" type="button">Update Customer</button>
                    <button class="btn btn-danger" type="button">Delete Customer</button>
                    <br>
                    <button class="btn btn-warning" type="button" id="clear">Clear</button>

                </div>
                <div class="col">
                </div>
            </div>
            <br>
            <div class="row">
                <div class="col">
                </div>

                <div class="col justify-content-center">
                    <table class="table table-hover">
                        <thead class="bg-danger text-white">
                        <tr class="justify-content-center">
                            <th>Id</th>
                            <th>Name</th>
                            <th>Address</th>
                            <th>Telephone</th>
                        </tr>
                        </thead>
                        <tbody id="tableCus">

                        </tbody>
                    </table>
                </div>
            </div>


        </div>
    </section>
    <section id="itempage">
        <div class="page" id="item">
            <br>
            <div class="row">
                <div class="col">
                </div>
                <div class="col">
                    <h4 class="justify-content-center" text>Item</h4>
                    <form class="form-floating">
                        <label for="itemId"></label><input class="form-control" id="itemId" placeholder="" type="text"
                                                           value="">
                        <label for="ItemId">Input Item ID</label>
                    </form>
                    <form class="form-floating">
                        <input class="form-control" id="itemName" placeholder="" type="text" value="">
                        <label for="itemName">Input Brand</label>
                    </form>
                    <form class="form-floating">
                        <input class="form-control" id="qty" placeholder="" type="text" value="">
                        <label for="qty">Input Qty</label>
                    </form>
                    <form class="form-floating">
                        <input class="form-control" id="uPrice" placeholder="" type="text"
                               value="">
                        <label for="uPrice">Input UnitPrice</label>
                    </form>

                    <br>
                    <button class="btn btn-primary " id="addItem" type="button">Add Item</button>
                    <button class="btn btn-warning " type="button">Update Item</button>
                    <button class="btn btn-danger" type="button">Delete Item</button>
                </div>
                <div class="col">
                </div>
            </div>
            <br>
            <div class="row">
                <div class="col">
                </div>

                <div class="col justify-content-center row-mt-4">
                    <table class="table table-hover">
                        <thead class="bg-danger text-white">
                        <tr class="justify-content-center">
                            <th>Id</th>
                            <th>Name</th>
                            <th>Qty</th>
                            <th>Unit Price</th>
                        </tr>
                        </thead>
                        <tbody id="tableItem">

                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>

</main>
<!--<script src="assets/JS/Script.js"></script>-->
<script src="assets/Bootstrap/js/bootstrap.bundle.js"></script>
<script src="assets/JS/jquery/jquery-3.6.0.min.js"></script>

<script>
    document.getElementById("customerpage").style.display = "none";
    document.getElementById("itempage").style.display = "none";

    //home btn
    document.getElementById("homeBtn").addEventListener("click", function () {
        document.getElementById("customerpage").style.display = "none";
        document.getElementById("itempage").style.display = "none";
        document.getElementById("homepage").style.display = "block";
    });

    //customer btn
    document.getElementById("customerBtn").addEventListener("click", function () {
        document.getElementById("homepage").style.display = "none";
        document.getElementById("itempage").style.display = "none";
        document.getElementById("customerpage").style.display = "block";
    });

    //item btn
    document.getElementById("itemBtn").addEventListener("click", function () {
        document.getElementById("homepage").style.display = "none";
        document.getElementById("customerpage").style.display = "none";
        document.getElementById("itempage").style.display = "block";
    });

    // customer form

    $("#addCustomer").click(function () {
        loadAllCustomers();
        clearAll();
        saveCustomer();
    })

    const cusIDRegEx = /^(C00-)[0-9]{1,3}$/;
    const cusNameRegEx = /^[A-z ]{7,30}$/;
    const cusAddressRegEx = /^[0-9/A-z. ,]{7,}$/;
    const cusTelNoRegEx = /^0[0-9][0-9]?(-)?[0-9]{7}$/;


    $('#id,#name,#address,#tpNum').on('keydown', function (eventOb) {
        if (eventOb.key == "Tab") {
            eventOb.preventDefault(); // stop execution of the button
        }
    });

    $('#id,#name,#address,#tpNum').on('blur', function () {
        formValid();
    });

    //focusing events
    $("#id").on('keyup', function (eventOb) {
        setButton();
        if (eventOb.key == "Enter") {
            checkIfValid();
        }

        if (eventOb.key == "Control") {
            var typedCustomerID = $("#id").val();
            var srcCustomer = searchCustomerFromID(typedCustomerID);
            $("#id").val(srcCustomer.getCustomerID());
            $("#name").val(srcCustomer.getCustomerName());
            $("#address").val(srcCustomer.getCustomerAddress());
            $("#tpNum").val(srcCustomer.getCustomerSalary());
        }


    });

    $("#name").on('keyup', function (eventOb) {
        setButton();
        if (eventOb.key == "Enter") {
            checkIfValid();
        }
    });

    $("#address").on('keyup', function (eventOb) {
        setButton();
        if (eventOb.key == "Enter") {
            checkIfValid();
        }
    });

    $("#tpNum").on('keyup', function (eventOb) {
        setButton();
        if (eventOb.key == "Enter") {
            checkIfValid();
        }
    });
    // focusing events end
    $("#addCustomer").attr('disabled', true);


    function clearAll() {
        $('#id,#name,#address,#tpNum').val("");
        $('#id,#name,#address,#tpNum').css('border', '2px solid #ced4da');
        $('#id').focus();
        $("#addCustomer").attr('disabled', true);
        loadAllCustomers();
        $("#cusId,#cusName,#cusAddress,#cusTpNum").text("");
    }

    function formValid() {
        var cusID = $("#id").val();
        $("#id").css('border', '2px solid green');
        $("#cusId").text("");
        if (cusIDRegEx.test(cusID)) {
            var cusName = $("#name").val();
            if (cusNameRegEx.test(cusName)) {
                $("#name").css('border', '2px solid green');
                $("#cusName").text("");
                var cusAddress = $("#address").val();
                if (cusAddressRegEx.test(cusAddress)) {
                    var cusTelNo = $("#tpNum").val();
                    var resp = cusTelNo.test(cusTelNo);
                    $("#address").css('border', '2px solid green');
                    $("#cusAddress").text("");
                    if (resp) {
                        $("#tpNum").css('border', '2px solid green');
                        $("#cusTpNum").text("");
                        return true;
                    } else {
                        $("#tpNum").css('border', '2px solid red');
                        $("#cusTpNum").text("Cus tel.no is a required field : Ex 011-23415621");
                        return false;
                    }
                } else {
                    $("#address").css('border', '2px solid red');
                    $("#cusAddress").text("Cus Name is a required field : Minimum 8");
                    return false;
                }
            } else {
                $("#name").css('border', '2px solid red');
                $("#cusName").text("Cus Name is a required field : Minimum 7, Max 20, Spaces Allowed");
                return false;
            }
        } else {
            $("#id").css('border', '2px solid red');
            $("#cusId").text("Cus ID is a required field : Pattern C00-000");
            return false;
        }
    }

    function checkIfValid() {
        var cusID = $("#id").val();
        if (cusIDRegEx.test(cusID)) {
            $("#name").focus();
            var cusName = $("#name").val();
            if (cusNameRegEx.test(cusName)) {
                $("#address").focus();
                var cusAddress = $("#address").val();
                if (cusAddressRegEx.test(cusAddress)) {
                    $("#cusTpNum").focus();
                    var cusTpNumber = $("#cusTpNum").val();
                    var resp = cusTelNoRegEx.test(cusTpNumber);
                    if (resp) {
                        let res = confirm("Do you really need to add this Customer..?");
                        if (res) {
                            saveCustomer();
                            clearAll();
                        }
                    } else {
                        $("#tpNum").focus();
                    }
                } else {
                    $("#address").focus();
                }
            } else {
                $("#name").focus();
            }
        } else {
            $("#id").focus();
        }
    }

    function setButton() {
        let b = formValid();
        if (b) {
            $("#addCustomer").attr('disabled', false);
        } else {
            $("#addCustomer").attr('disabled', true);
        }
    }

    $('#addCustomer').click(function () {
        checkIfValid();
    });

    /*CRUD --> Customer --> Started*/

    //load all Customers
    function loadAllCustomers() {
        $("#tableCus").empty();
        for (var i of customerDB) {
            /*create a html row*/
            let row = `<tr><td>${i.id}</td><td>${i.name}</td><td>${i.address}</td><td>${i.salary}</td></tr>`;
            /*select the table body and append the row */
            $("#customerTable").append(row);
        }
    }

    //save Customers
    function saveCustomer() {
        let cusID = $("#id").val();
        let cusName = $("#name").val();
        let cusAddress = $("#address").val();
        let cusTpNo = $("#tpNum").val();

        //create Object
        var customerObject = {
            id: cusID,
            name: cusName,
            address: cusAddress,
            tpNum: cusTpNo
        };

        customerDb.push(customerObject);
    }

    /*CRUD --> Customer --> Ended*/



    // item form
    $("#addItem").click(function () {

        $("#tableCus>tr").off();

        let itemId = $("#itemId").val();
        let itemName = $("#itemName").val();
        let itemQty = $("#qty").val();
        let itemUnitPrice = $("#uPrice").val();

        let row1 = `<tr><td>${itemId}</td><td>${itemName}</td><td>${itemQty}</td><td>${itemUnitPrice}</td>`;
        $("#tableItem").append(row1);


        $("#tableItem>tr").click(function () {
            let iId = $(this).children(":eq(0)").text();
            let iName = $(this).children(":eq(1)").text();
            let iQty = $(this).children(":eq(2)").text();
            let iUniPrice = $(this).children(":eq(3)").text();

            $("#itemId").val(iId);
            $("#itemName").val(iName);
            $("#qty").val(iQty);
            $("#uPrice").val(iUniPrice);
        });

    });

</script>
</body>
</html>